//Middleware

// server_practice_X.js â€” Topic: _____________
// Change the port number per file to avoid conflicts (e.g. 3000, 3001, etc)

const express = require("express");
const app = express();

// Middleware: allows Express to read JSON body data
app.use(express.json());

//routes

app.post("/task", validateTask, (req, res) => {
  res.send(`Task '${req.body.task} recieved.`);
});

//Error Handler

app.use((err, req, res, next) => {
  console.error("ERROR", err.message);
  res.status(500).json({error: err.message});
})


/////////////////
app.get("/", (req, res) => {
  res.send("Server Practice 4 is running!");
});

// âš ï¸ Express 5 â€” catch-all 404 handler
app.use((req, res) => {
  res.status(404).send("Page not found");
});

app.unsubscribe((err, req, res, next => {
  console.error("ERR:", err.message);
  res.status(500).json({error:err.message });
}));

// ðŸŸ¢ Start the server
app.listen(3032, () => {
  console.log("Server Practice 4 running at http://localhost:3032");
});



//more examples
// npx nodemon server-practice/server_practice_4.js




//ðŸ§  Core Principles to Remember

//Middleware runs in order â€” write them from general â†’ specific â†’ fallback.

//Every middleware must end in either res.send() / res.json() or next().

//If you send a response, the chain stops.

//404 handler should be after all routes.

//Error handler must be last and have 4 parameters (err, req, res, next).


